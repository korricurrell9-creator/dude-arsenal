const { runSystemCommand } = require('../utils/exec');

module.exports = (bot, config) => {
    
    // /vuln <target>
    bot.command('vuln', (ctx) => {
        if (ctx.from.id !== config.OWNER_ID) return;
        const target = ctx.payload;
        if (!target) return ctx.reply('Usage: /vuln <target>');
        runSystemCommand(ctx, `nmap -Pn --script vuln ${target}`, `Vuln Scan on ${target}`);
    });

    // /nikto <url>
    bot.command('nikto', (ctx) => {
        if (ctx.from.id !== config.OWNER_ID) return;
        const target = ctx.payload;
        if (!target) return ctx.reply('Usage: /nikto <url>');
        runSystemCommand(ctx, `nikto -h ${target} -maxtime 2m`, `Nikto Scan on ${target}`);
    });

    // /sqlmap <url>
    bot.command('sqlmap', (ctx) => {
        if (ctx.from.id !== config.OWNER_ID) return;
        const target = ctx.payload;
        if (!target) return ctx.reply('Usage: /sqlmap <url>');
        runSystemCommand(ctx, `sqlmap -u "${target}" --batch --crawl=1 --level=1 --risk=1`, `SQLMap on ${target}`);
    });
};
